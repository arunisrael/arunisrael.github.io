<div dir="ltr" style="text-align: left;" trbidi="on">
<span style="font-family: Arial, Helvetica, sans-serif;">Inside the new Error Message Minification service of Angular.js, <a href="http://kensheedlo.com/2013/08/15/error-message-minification-with-minerr.html">MinErr</a>, there are some interesting pieces of code. The first looks at how the unary plus operator is used and the second is a regex used in converting a function to a string.</span><br />
<br />
<span style="font-family: Arial, Helvetica, sans-serif;">match below is a string such as '{0}', '{1}', '{2}', etc. The slice extracts the integer within the braces.</span><br />
<span style="font-family: Arial, Helvetica, sans-serif;"><br /></span>
<span class="kd" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">var</span><span style="background-color: #ffffcc; color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="nx" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">index</span><span style="background-color: #ffffcc; color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="o" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">=</span><span style="background-color: #ffffcc; color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="o" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">+</span><span class="nx" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">match</span><span class="p" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">.</span><span class="nx" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">slice</span><span class="p" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">(</span><span class="mi" style="color: #009999; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">1</span><span class="p" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">,</span><span style="background-color: #ffffcc; color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="o" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">-</span><span class="mi" style="color: #009999; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">1</span><span class="p" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">)</span><br />
<span class="p" style="color: #333333; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"><br /></span>
<span style="font-family: Arial, Helvetica, sans-serif;">The unary plus operator does the following according to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators?redirectlocale=en-US&amp;redirectslug=JavaScript%2FReference%2FOperators%2FArithmetic_Operators#-_.28Unary_Plus.29">MDN</a>:</span><br />
<span style="background-color: white; color: #333333; font-family: 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Lucida, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px;">&nbsp;...unary plus is the fastest and preferred way of converting something into a number, because it does not perform any other operations on the number. It can convert string representations of integers and floats...</span><br />
<span style="background-color: white; color: #333333; font-family: 'Lucida Grande', 'Lucida Sans Unicode', 'DejaVu Sans', Lucida, Arial, Helvetica, sans-serif; font-size: 14px; line-height: 21px;"><br /></span>
<span style="font-family: Arial, Helvetica, sans-serif;">So we see that the code above converts '{0}' to the number 0 to index into an array.</span><br />
<span style="font-family: Arial, Helvetica, sans-serif;"><br /></span>
<span style="font-family: Arial, Helvetica, sans-serif;">The code below invokes the toString method on the passed in function and strips out the body of the function leaving the function name and argument list.</span><br />
<pre style="color: #333333; line-height: 18px;"><div class="line" id="LC38" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; padding-left: 10px;">
<span class="k" style="font-weight: bold;">if</span> <span class="p">(</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">obj</span><span class="p">))</span> <span class="p">{</span></div>
<div class="line" id="LC39" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; padding-left: 10px;">
<span class="k">  </span><span class="k" style="font-weight: bold;">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="sr" style="color: #009926;">/ \{[\s\S]*$/</span><span class="p">,</span> <span class="s1" style="color: #dd1144;">''</span><span class="p">);</span></div>
<div class="line" id="LC39" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; padding-left: 10px;">
}</div>
<div class="line" id="LC39" style="padding-left: 10px;">
<span style="font-family: Arial, Helvetica, sans-serif;">
</span></div>
<div class="line" id="LC39" style="padding-left: 10px;">
<span style="font-family: Arial, Helvetica, sans-serif;">Notice the use of the character class [\s\S]* instead of the simpler .* notation. A common misconception is that the . character matches everything. However, the . character does not match newline characters. So the .* regex would not strip out function bodies with newline characters.</span></div>
</pre>
</div>

